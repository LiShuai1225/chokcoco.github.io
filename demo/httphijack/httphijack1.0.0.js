(function(t,e){var n=function(){},r={},o=0;var i=["www.yy.com","res.cont.yy.com"];var c=["192.168.1.0"];var a=["xss","BAIDU_SSP__wrapper","BAIDU_DSPUI_FLOWBAR"];function s(t,e){var n=t=="onclick";function i(c){var a=c["isScan"],s="",u=0;if(!a){a=c["isScan"]=++o}u=a<<8|e;if(u in r){return}r[u]=true;if(c.nodeType!=Node.ELEMENT_NODE){return}if(c[t]){s=c.getAttribute(t);if(s&&/xss/i.test(s)){c[t]=null;console.log("拦截可疑内联事件:"+s);y("拦截可疑内联事件",s)}}if(n&&c.tagName=="A"&&c.protocol=="javascript:"){var s=c.href.substr(11);if(/xss/i.test(s)){c.href="javascript:void(0)";console.log("拦截可疑事件:"+s);y("拦截可疑javascript:代码",s)}}i(c.parentNode)}document.addEventListener(t.substr(2),function(t){i(t.target)},true)}function u(){var t=0,e=null;for(e in document){if(/^on./.test(e)){s(e,t++)}}}function f(){var t=new MutationObserver(function(t){t.forEach(function(t){var e=t.addedNodes;for(var n=0;n<e.length;n++){var r=e[n];if(/xss/i.test(r.src)||/xss/i.test(r.innerHTML)){try{r.parentNode.removeChild(r)}catch(o){var i=1}if(!i){console.log("拦截可疑静态脚本:",r);y("拦截可疑静态脚本",r.src)}}}})});t.observe(document,{subtree:true,childList:true})}function l(){document.addEventListener("DOMNodeInserted",function(t){var e=t.target;if(/xss/i.test(e.src)||/xss/i.test(e.innerHTML)){e.parentNode.removeChild(e);console.log("拦截可疑动态脚本:",e);y("拦截可疑动态脚本",e.src)}},true)}function d(){}function p(t){var e=t.document.write;t.document.write=function(t){if(/xss/i.test(t)){console.log("拦截可疑模块:",t);y("拦截可疑document-write",t);return}e.apply(document,arguments)}}function v(t){var e=t.Element.prototype.setAttribute;t.Element.prototype.setAttribute=function(t,n){if(this.tagName=="SCRIPT"&&/^src$/i.test(t)){if(/xss/i.test(n)){console.log("拦截可疑模块:",n);y("拦截可疑setAttribute",string);return}}e.apply(this,arguments)}}function m(){function e(t){v(t);p(t);t.document.addEventListener("DOMNodeInserted",function(t){var n=t.target;if(n.tagName=="IFRAME"){e(n.contentWindow)}},true)}e(t)}function g(){Object.defineProperty(Function.prototype,"call",{value:Function.prototype.call,writable:false,configurable:false,enumerable:true});Object.defineProperty(Function.prototype,"apply",{value:Function.prototype.apply,writable:false,configurable:false,enumerable:true})}function h(){var t="iframe_hijack_redirected";if(self!=top){var e=document.referrer,n=i.length,r=0;for(;r<n;r++){var o=new RegExp(i[r],"i");if(o.test(e)){return}}var c=location.href;var a=c.split("#");if(location.search){a[0]+="&"+t+"=1"}else{a[0]+="?"+t+"=1"}try{console.log("页面被嵌入iframe中:",e);y("页面被嵌入iframe中",e);top.location.href=a.join("#")}catch(s){}}}function y(t,e){var n=document.createElement("img"),r=t,o=e.toString(),i=(new Date).getTime();n.src="http://172.19.99.179:3002/report/?msg="+r+"&value="+o+"&time="+i}n.init=function(){u();f();l();g();m();h()};t.httphijack=n})(window);
!function(e,t){function o(){var e=0,t=null;for(t in document)/^on./.test(t)&&r(t,e++)}function r(e,t){var o="onclick"==e;document.addEventListener(e.substr(2),function(r){n(r.target,o,e,t)},!0)}function n(e,t,o,r){var i=e.isScan,c="",a=0;if(i||(i=e.isScan=++b),a=i<<8|r,!(a in g)&&(g[a]=!0,e.nodeType==Node.ELEMENT_NODE)){if(e[o]&&(c=e.getAttribute(o),c&&p(E,c)&&(e[o]=null,console.log("拦截可疑内联事件:"+c),v("拦截可疑内联事件",c))),t&&"A"==e.tagName&&"javascript:"==e.protocol){var c=e.href.substr(11);p(E,string)&&(e.href="javascript:void(0)",console.log("拦截可疑事件:"+c),v("拦截可疑javascript:代码",c))}n(e.parentNode)}}function i(){var t=e.MutationObserver||e.WebKitMutationObserver||e.MozMutationObserver,o=new t(function(e){e.forEach(function(e){for(var t=e.addedNodes,o=0;o<t.length;o++){var r=t[o];"SCRIPT"!==r.tagName&&"IFRAME"!==r.tagName||("IFRAME"===r.tagName&&r.srcdoc?(r.parentNode.removeChild(r),console.log("拦截到可疑iframe",r.srcdoc),v("拦截可疑静态脚本",r.srcdoc)):r.src&&(d(h,r.src)||(r.parentNode.removeChild(r),console.log("拦截可疑静态脚本:",r.src),v("拦截可疑静态脚本",r.src))))}})});o.observe(document,{subtree:!0,childList:!0})}function c(e){var t=e.document.write;e.document.write=function(e){return p(E,e)?(console.log("拦截可疑模块:",e),void v("拦截可疑document-write",e)):void t.apply(document,arguments)}}function a(e){var t=e.Element.prototype.setAttribute;e.Element.prototype.setAttribute=function(e,o){return"SCRIPT"==this.tagName&&/^src$/i.test(e)&&!d(w,o)?(console.log("拦截可疑模块:",o),void v("拦截可疑setAttribute",o)):void t.apply(this,arguments)}}function u(){s(e)}function s(e){a(e),c(e);var t=e.MutationObserver||e.WebKitMutationObserver||e.MozMutationObserver,o=new t(function(e){e.forEach(function(e){for(var t=e.addedNodes,o=0;o<t.length;o++){var r=t[o];"IFRAME"==r.tagName&&s(r.contentWindow)}})});o.observe(document,{subtree:!0,childList:!0})}function l(){Object.defineProperty(Function.prototype,"call",{value:Function.prototype.call,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(Function.prototype,"apply",{value:Function.prototype.apply,writable:!1,configurable:!1,enumerable:!0})}function f(){var e="iframe_hijack_redirected";if(self!=top){for(var t=document.referrer,o=w.length,r=0;o>r;r++){var n=new RegExp(w[r],"i");if(n.test(t))return}var i=location.href,c=i.split("#");location.search?c[0]+="&"+e+"=1":c[0]+="?"+e+"=1";try{console.log("页面被嵌入iframe中:",t),v("页面被嵌入iframe中",t),top.location.href=c.join("#")}catch(a){}}}function v(e,t){var o=document.createElement("img"),r=e,n=t.toString(),i=(new Date).getTime();o.src="http://www.reportServer.com/report/?msg="+r+"&value="+n+"&time="+i}function d(e,t){for(var o=e.length,r=0;o>r;r++){var n=new RegExp(w[r],"i");if(n.test(t))return!0}return!1}function p(e,t){for(var o=e.length,r=0;o>r;r++){var n=new RegExp(e[r],"i");if(n.test(t))return!0}return!1}var m=function(){},g={},b=0,w=["www.aaa.com","www.bbb.com","s4.cnzz.com"],h=["192.168.1.0"],E=["xss","BAIDU_SSP__wrapper","BAIDU_DSPUI_FLOWBAR"];m.init=function(){o(),i(),l(),u(),f()},e.httphijack=m}(window);